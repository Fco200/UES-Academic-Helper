<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registro | UES Helper</title>
    <link rel="icon" type="image/png" href="logo.png">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        :root { --ues-guinda: #800000; --ues-oro: #b8860b; }
        body { background: #fdfdfd; height: 100vh; display: flex; align-items: center; justify-content: center; font-family: 'Plus Jakarta Sans', sans-serif; margin: 0; color: #333; overflow: hidden; }
        #particles-js { position: absolute; width: 100%; height: 100%; z-index: 1; opacity: 0.5; }
        .register-container { background: white; border: 1px solid #eee; border-radius: 35px; width: 100%; max-width: 420px; padding: 40px; box-shadow: 0 15px 35px rgba(0,0,0,0.08); position: relative; z-index: 10; }
        .brand-title { font-weight: 800; font-size: 2rem; color: #111; letter-spacing: -1px; }
        .brand-title span { color: var(--ues-guinda); }
        .form-label { font-size: 0.7rem; font-weight: 700; color: #888; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 8px; }
        .form-control { background: #f8f9fa !important; border: 1px solid #ddd !important; color: #333 !important; border-radius: 12px; padding: 12px 18px; margin-bottom: 20px; }
        .btn-main { background: var(--ues-guinda); border: none; border-radius: 12px; padding: 16px; width: 100%; font-weight: 700; color: white; transition: 0.4s; text-transform: uppercase; box-shadow: 0 4px 15px rgba(128,0,0,0.2); }
        .btn-main:hover { background: #a00000; transform: translateY(-2px); }
        .footer-link { margin-top: 25px; display: block; text-decoration: none; color: #888; font-size: 0.85rem; font-weight: 600; transition: 0.3s; }
        .footer-link:hover { color: var(--ues-guinda); }
    </style>
</head>
<body>
    <div id="particles-js"></div>
    <div class="register-container">
        <div class="text-center mb-4">
            <h1 class="brand-title">Únete a <span>Helper</span></h1>
            <p class="text-muted small fw-bold">Crea tu cuenta académica hoy</p>
        </div>

        <div class="mb-3">
            <label class="form-label">Nombre Completo</label>
            <input type="text" id="regNombre" class="form-control" placeholder="Ej. Francisco Aguayo">
        </div>

        <div class="mb-3">
            <label class="form-label">Correo Institucional</label>
            <input type="email" id="regIdentificador" class="form-control" placeholder="usuario@ues.mx">
        </div>

        <div class="mb-3">
            <label class="form-label">Contraseña</label>
            <input type="password" id="regPass" class="form-control" placeholder="Mínimo 6 caracteres">
        </div>

        <button onclick="ejecutarRegistro()" class="btn-main" id="btnRegistro">
            CREAR CUENTA <i class="fas fa-arrow-right ms-2"></i>
        </button>

        <div class="text-center">
            <a href="/index.html" class="footer-link">
                <i class="fas fa-arrow-left me-2"></i> ¿Ya tienes cuenta? Inicia sesión
            </a>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
    <script>
        particlesJS("particles-js", {"particles":{"number":{"value":40},"color":{"value":"#800000"},"opacity":{"value":0.2},"move":{"speed":1}}});

        async function ejecutarRegistro() {
            const btn = document.getElementById('btnRegistro');
            const d = { 
                nombre: document.getElementById('regNombre').value.trim(), 
                identificador: document.getElementById('regIdentificador').value.toLowerCase().trim(), 
                password: document.getElementById('regPass').value, 
                universidad: "UES", 
                carrera: "Software" 
            };

            if(!d.nombre || !d.identificador || !d.password) return alert("⚠️ Por favor, llena todos los campos.");
            if(d.password.length < 6) return alert("❌ La contraseña debe tener al menos 6 caracteres.");

            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> PROCESANDO...';
            btn.disabled = true;

            try {
                const res = await fetch('/nuevo-registro', { 
                    method: 'POST', 
                    headers: {'Content-Type': 'application/json'}, 
                    body: JSON.stringify(d) 
                });

                if(res.ok) { 
                    alert("✅ ¡Cuenta creada con éxito! Ahora puedes iniciar sesión."); 
                    window.location.href = "/index.html"; 
                } else { 
                    alert("❌ El correo ya está registrado."); 
                    btn.innerHTML = 'CREAR CUENTA <i class="fas fa-arrow-right ms-2"></i>';
                    btn.disabled = false;
                }
            } catch (e) {
                alert("❌ Error de conexión con el servidor.");
                btn.disabled = false;
            }
        }
    </script>
</body>
</html>